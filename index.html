html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Cherrak Infinity â™¾ï¸ â€” Coffre / Ø§Ù„Ø®Ø²Ù†Ø©</title>
<style>
  /* --------- Basic reset & theme (Cyber Futuristic) --------- */
  :root{
    --bg:#020617; --panel:#071827; --accent:#00e0ff; --muted:#9fbcd6; --danger:#ff6b6b;
    --glass: rgba(255,255,255,0.03);
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,Segoe UI,Arial,'Noto Naskh Arabic',Tahoma;background:linear-gradient(180deg,#000,#021022);color:#eaf6ff;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:18px}
  .wrap{width:100%;max-width:1200px;background:linear-gradient(180deg,rgba(255,255,255,0.01),rgba(255,255,255,0.00));border-radius:14px;padding:18px;border:1px solid rgba(255,255,255,0.04);box-shadow:0 8px 40px rgba(0,0,0,0.6)}
  .top{display:flex;align-items:center;gap:12px}
  .logo{width:64px;height:64px;border-radius:12px;background:linear-gradient(180deg,#022831,#02101a);display:flex;align-items:center;justify-content:center;font-size:30px;color:var(--accent)}
  h1{margin:0;font-size:20px;color:#bfefff}
  .muted{color:var(--muted);font-size:13px}
  .clock{margin-left:auto;color:var(--muted);font-size:13px}

  /* Panels */
  .panel{margin-top:12px;padding:14px;border-radius:12px;background:linear-gradient(180deg,rgba(255,255,255,0.01),transparent);border:1px solid rgba(255,255,255,0.03)}
  .hidden{display:none}
  .center{text-align:center}

  /* Vault visual */
  .vault-visual{display:flex;align-items:center;gap:16px;justify-content:center;position:relative;padding:12px}
  .door{width:420px;height:340px;background:linear-gradient(180deg,#071a2a,#041018);border-radius:12px;display:flex;align-items:center;justify-content:center;position:relative;box-shadow:0 20px 60px rgba(0,0,0,0.6)}
  .door-panel{width:360px;height:280px;background:linear-gradient(180deg,#021517,#001217);border-radius:10px;display:flex;flex-direction:column;align-items:center;justify-content:center;position:relative;padding:16px}
  .locks{position:absolute;top:18px;left:18px;display:flex;gap:8px}
  .lock{width:18px;height:18px;border-radius:4px;background:#001;box-shadow:inset 0 2px 6px rgba(0,0,0,0.6)}
  .lock.big{width:28px;height:28px}
  .door-title{font-weight:800;color:var(--accent);font-size:20px}
  .door-sub{font-size:13px;color:var(--muted)}

  .robot{width:120px;height:120px;border-radius:12px;display:flex;align-items:center;justify-content:center}
  .robot img{width:110px;height:110px;object-fit:contain}

  .avatar{position:absolute;right:22px;top:12px;width:86px;height:86px;border-radius:10px;overflow:hidden;border:2px solid rgba(255,255,255,0.04)}
  .avatar img{width:100%;height:100%;object-fit:cover}

  /* Form & controls */
  .form{max-width:580px;margin:12px auto}
  input,select,button,textarea{font-size:15px;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.05);background:transparent;color:inherit}
  input[type="number"]{-moz-appearance:textfield}
  .row{display:flex;gap:8px}
  .btn{padding:10px 12px;border-radius:10px;border:none;background:var(--accent);color:#001;font-weight:700;cursor:pointer}
  .ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--accent)}
  .danger{background:var(--danger);color:#111}
  .note{margin-top:8px;color:var(--muted);font-size:13px}

  /* Apps grid */
  .tools{display:flex;gap:8px;margin-top:10px}
  .apps-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:10px;margin-top:12px}
  .app-card{background:linear-gradient(180deg,#001922,#001016);padding:10px;border-radius:10px;display:flex;gap:8px;align-items:center}
  .app-thumb{width:56px;height:56px;border-radius:8px;background:#00212b;display:flex;align-items:center;justify-content:center;font-weight:700}
  .log{background:#021219;padding:10px;border-radius:8px;color:#bfefff;max-height:240px;overflow:auto;margin-top:12px}

  /* Quran panel */
  .q-panel{display:flex;gap:12px;flex-wrap:wrap;margin-top:12px}
  .q-index{width:260px}
  .q-main{flex:1;min-width:320px}
  .q-list{max-height:320px;overflow:auto;padding:8px;border-radius:8px;background:rgba(255,255,255,0.01)}

  /* Footer */
  .foot{text-align:center;color:var(--muted);margin-top:14px;font-size:13px}

  /* small responsive */
  @media(max-width:840px){
    .vault-visual{flex-direction:column}
    .avatar{position:static;margin-top:10px}
  }
</style>
</head>
<body>
<div class="wrap">
  <div class="top" role="banner">
    <div style="display:flex;align-items:center;gap:12px">
      <div class="logo">â™¾ï¸</div>
      <div>
        <h1>Cherrak Infinity â™¾ï¸</h1>
        <div class="muted">The Vault â€” Ø§Ù„Ø®Ø²Ù†Ø© Ø§Ù„Ø°ÙƒÙŠØ©</div>
      </div>
    </div>
    <div style="display:flex;align-items:center;gap:12px">
      <select id="lang" aria-label="language">
        <option value="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
        <option value="en">English</option>
      </select>
      <div class="clock" id="clock">--:--:--</div>
    </div>
  </div>

  <!-- GATE -->
  <section id="gatePanel" class="panel">
    <div class="vault-visual">
      <div class="robot" id="robotWrap">
        <img id="robotImg" src="robot.png" alt="robot">
      </div>

      <div class="door" id="door">
        <div class="door-panel">
          <div class="locks">
            <div class="lock small"></div>
            <div class="lock small"></div>
            <div class="lock big"></div>
          </div>
          <div class="door-title" id="doorTitle">Ø¨Ø§Ø¨ Ø§Ù„Ø®Ø²Ù†Ø© / Vault Door</div>
          <div class="door-sub" id="doorSub">Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù„ÙØªØ­ â€” Enter password to open</div>
        </div>
      </div>

      <div class="avatar" title="Ù…Ø§Ù„Ùƒ Ø§Ù„Ø­Ø³Ø§Ø¨">
        <img id="avatarImg" src="avatar.png" alt="avatar">
      </div>
    </div>

    <div class="form center">
      <input id="password" placeholder="Bismillah" autocomplete="off" />
      <input id="age" type="number" min="1" placeholder="Ø¹Ù…Ø±Ùƒ / Age" />
      <div class="row" style="margin-top:8px;justify-content:center">
        <button id="unlockBtn" class="btn">ÙØªØ­ / Open</button>
        <button id="ownerToggle" class="btn ghost">Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø§Ù„Ùƒ / Owner</button>
      </div>
      <div id="gateMsg" class="note"></div>
      <div class="note">ÙŠØ³Ù…Ø­ Ù„Ù…Ù† ÙÙˆÙ‚ 12 Ø³Ù†Ø© â€¢ ÙŠÙØªØ­ Ù…Ù† 08:00 Ø¥Ù„Ù‰ 22:00</div>
    </div>
  </section>

  <!-- VAULT -->
  <section id="vaultPanel" class="panel hidden">
    <div style="display:flex;align-items:center;justify-content:space-between">
      <div>
        <strong>ğŸ”“ Ø§Ù„Ø®Ø²Ù†Ø© â€” The Vault</strong>
        <div class="muted">A fast, comprehensive site â€” AI without limits</div>
      </div>
      <div>
        <button id="lockBtn" class="btn ghost">Ù‚ÙÙ„ / Lock</button>
        <button id="logoutBtn" class="btn danger">Ø®Ø±ÙˆØ¬ / Logout</button>
      </div>
    </div>

    <p style="margin-top:12px">
      <em>Cherrak Infinity â™¾ï¸ â€” Ù…ØºÙ†Ø§Ø·ÙŠØ³ Ø±Ù‚Ù…ÙŠ ÙŠØ¬Ø°Ø¨ Ø¥Ù„ÙŠÙ‡ Ø±ÙˆØ§Ø¯ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ØŒ Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±ÙŠÙ†ØŒ ÙˆØ§Ù„Ù…Ø¤Ø«Ø±ÙŠÙ† Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠÙŠÙ†.</em>
    </p>

    <div class="add-row" style="display:flex;gap:8px;margin-top:8px">
      <input id="appTitle" placeholder="Ø§Ø³Ù… Ø§Ù„ØªØ·Ø¨ÙŠÙ‚/Ø§Ù„Ù…ÙˆÙ‚Ø¹ / App or Site name" />
      <input id="appUrl" placeholder="https://example.com" />
      <button id="addApp" class="btn">Ø£Ø¶Ù / Add</button>
    </div>

    <div class="tools">
      <button id="magnetBtn" class="btn">ğŸ§² Magnet Pull (curated)</button>
      <button id="magnetBiz" class="btn">ğŸ§² Magnet â€” Business Picks</button>
      <button id="protectBtn" class="btn ghost">Ø­Ù…Ø§ÙŠØ© ØªØµÙˆÙŠØ± / Protect</button>
    </div>

    <div id="appsList" class="apps-grid"></div>

    <div style="margin-top:12px" class="q-panel">
      <!-- Quran index -->
      <div class="q-index panel">
        <h3>Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ… / Quran</h3>
        <div class="muted">Ø§Ø®ØªØ± Ø§Ù„Ø³ÙˆØ±Ø© â€” select a surah</div>
        <div class="q-list" id="surahList">ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³ÙˆØ±...</div>
      </div>

      <!-- Quran main -->
      <div class="q-main panel">
        <div style="display:flex;gap:8px;align-items:center">
          <select id="reciterSelect"></select>
          <select id="translationSelect"></select>
          <button id="playAyah" class="btn">â–¶ï¸ ØªØ´ØºÙŠÙ„</button>
          <button id="stopAyah" class="btn ghost">â–  Ø¥ÙŠÙ‚Ø§Ù</button>
        </div>
        <div id="qText" style="margin-top:12px;max-height:320px;overflow:auto;padding:8px;background:rgba(255,255,255,0.01);border-radius:8px"></div>
        <div id="qTafsir" style="margin-top:10px;color:var(--muted);font-size:14px"></div>
      </div>
    </div>

    <hr>

    <h3>ÙƒØªØ¨ ÙÙ‚Ù‡ÙŠØ© ÙˆÙ…Ø¬Ù„Ø¯Ø§Øª (Ø±ÙˆØ§Ø¨Ø· Ø¹Ø§Ù…Ø©)</h3>
    <ul>
      <li><a href="https://sunnah.com/bukhari" target="_blank" rel="noopener">ØµØ­ÙŠØ­ Ø§Ù„Ø¨Ø®Ø§Ø±ÙŠ â€” Sunnah.com</a></li>
      <li><a href="https://sunnah.com/muslim" target="_blank" rel="noopener">ØµØ­ÙŠØ­ Ù…Ø³Ù„Ù… â€” Sunnah.com</a></li>
      <li><a href="https://ia800304.us.archive.org/27/items/waq49585/waq49585.pdf" target="_blank" rel="noopener">Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© ÙˆØ§Ù„Ù†Ù‡Ø§ÙŠØ© â€” Ø§Ø¨Ù† ÙƒØ«ÙŠØ± (Ù†Ø³Ø®Ø© Ø£Ø±Ø´ÙŠÙ)</a></li>
      <li><a href="https://shamela.ws/index.php/book/3410" target="_blank" rel="noopener">Ø§Ù„Ù…ÙˆØ·Ø£ â€” Ø§Ù„Ø¥Ù…Ø§Ù… Ù…Ø§Ù„Ùƒ (Shamela)</a></li>
      <li><a href="https://archive.org/details/lisanalarab" target="_blank" rel="noopener">Ù„Ø³Ø§Ù† Ø§Ù„Ø¹Ø±Ø¨ â€” Archive.org (Ø§Ø¬Ø²Ø§Ø¡)</a></li>
      <li><a href="https://archive.org" target="_blank" rel="noopener">Ù…Ø²ÙŠØ¯ ÙÙŠ Archive.org (Ù…ØµØ§Ø¯Ø± Ø¹Ø§Ù…Ø©)</a></li>
    </ul>

    <h3>Ù…ÙƒØªØ¨Ø© Ø¹Ø§Ù„Ù…ÙŠØ© â€” Ø£Ø´Ù‡Ø± Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„ØªØ¬Ø§Ø±Ø© Ùˆ Ø§Ù„Ø®Ø¯Ù…Ø§Øª</h3>
    <div class="apps-grid" style="margin-top:8px">
      <!-- quick curated links -->
      <div class="app-card"><div class="app-thumb">G</div><div style="flex:1"><strong>Google</strong><div class="muted">Search</div></div><div><button onclick="openSite('https://www.google.com')" class="btn">ÙØªØ­</button></div></div>
      <div class="app-card"><div class="app-thumb">A</div><div style="flex:1"><strong>Amazon</strong><div class="muted">Shopping</div></div><div><button onclick="openSite('https://www.amazon.com')" class="btn">ÙØªØ­</button></div></div>
      <div class="app-card"><div class="app-thumb">E</div><div style="flex:1"><strong>eBay</strong><div class="muted">Marketplace</div></div><div><button onclick="openSite('https://www.ebay.com')" class="btn">ÙØªØ­</button></div></div>
      <div class="app-card"><div class="app-thumb">AL</div><div style="flex:1"><strong>Alibaba</strong><div class="muted">Trade</div></div><div><button onclick="openSite('https://www.alibaba.com')" class="btn">ÙØªØ­</button></div></div>
      <div class="app-card"><div class="app-thumb">P</div><div style="flex:1"><strong>PayPal</strong><div class="muted">Payments</div></div><div><button onclick="openSite('https://www.paypal.com')" class="btn">ÙØªØ­</button></div></div>
      <div class="app-card"><div class="app-thumb">M</div><div style="flex:1"><strong>Mastercard</strong><div class="muted">Banking</div></div><div><button onclick="openSite('https://www.mastercard.com')" class="btn">ÙØªØ­</button></div></div>
    </div>

    <h3 style="margin-top:12px">Ø³Ø¬Ù„ Ù…Ø­Ù„ÙŠ / Audit Log</h3>
    <pre id="logArea" class="log">Ø§Ù„Ø³Ø¬Ù„ ÙØ§Ø±Øº</pre>

    <!-- Owner panel -->
    <div id="ownerPanel" class="owner-panel hidden panel" style="margin-top:12px">
      <h4>Owner â€” Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø§Ù„Ùƒ</h4>
      <div class="row">
        <input id="ownerPass" placeholder="Owner password" type="password" />
        <button id="ownerLogin" class="btn">ØªØ³Ø¬ÙŠÙ„ / Login</button>
      </div>
      <div id="ownerActions" class="hidden" style="margin-top:8px">
        <input id="globalTitle" placeholder="Global link title" />
        <input id="globalUrl" placeholder="https://example.com" />
        <div class="row" style="margin-top:8px">
          <button id="addGlobalBtn" class="btn">Ø£Ø¶Ù Ø±Ø§Ø¨Ø· Ø¹Ø§Ù…</button>
          <button id="clearAll" class="btn ghost">Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„</button>
          <button id="magnetServer" class="btn">Magnet Pull (server)</button>
        </div>
        <div id="ownerMsg" class="muted" style="margin-top:8px"></div>
      </div>
    </div>

  </section>

  <footer class="foot">Â© Cherrak Infinity â€” Local-first â€¢ Privacy-focused</footer>
</div>

<!-- Audio & hidden "GPT-7 Tesla Einstein" engine marker -->
<audio id="bismillahAudio" src="bismillah.mp3" preload="auto"></audio>
<audio id="robotAudio" src="robot-sound.mp3" preload="auto"></audio>
<script>
/* ==================== Configuration ==================== */
const USER_PASS = "Bismillah";
const OWNER_PASS = "Cherrak Houari";
const MIN_AGE = 12;
const OPEN_HOUR = 8;
const CLOSE_HOUR = 22;
const BLOCKED = ["porn","sex","xxx","nude","erotic","pornography","malware","virus","torrent","piracy"];
const MAGNET_BUSINESS = [
  {title:'Crunchbase', url:'https://www.crunchbase.com'},
  {title:'AngelList', url:'https://angel.co'},
  {title:'TechCrunch', url:'https://techcrunch.com'},
  {title:'Forbes', url:'https://forbes.com'},
  {title:'LinkedIn', url:'https://www.linkedin.com'}
];
/* Hidden brain name: GPT-7 Tesla Einstein (internal) */
const HIDDEN_AI_NAME = "GPT-7 Tesla Einstein";

/* ====== Helpers & DOM refs ====== */
const clockEl = document.getElementById('clock');
const langSel = document.getElementById('lang');
const gatePanel = document.getElementById('gatePanel');
const vaultPanel = document.getElementById('vaultPanel');
const passwordInput = document.getElementById('password');
const ageInput = document.getElementById('age');
const unlockBtn = document.getElementById('unlockBtn');
const ownerToggle = document.getElementById('ownerToggle');
const gateMsg = document.getElementById('gateMsg');

const addAppBtn = document.getElementById('addApp');
const appTitle = document.getElementById('appTitle');
const appUrl = document.getElementById('appUrl');
const appsList = document.getElementById('appsList');
const magnetBtn = document.getElementById('magnetBtn');
const magnetBiz = document.getElementById('magnetBiz');
const protectBtn = document.getElementById('protectBtn');

const lockBtn = document.getElementById('lockBtn');
const logoutBtn = document.getElementById('logoutBtn');

const surahListEl = document.getElementById('surahList');
const qText = document.getElementById('qText');
const qTafsir = document.getElementById('qTafsir');
const reciterSelect = document.getElementById('reciterSelect');
const translationSelect = document.getElementById('translationSelect');
const playAyah = document.getElementById('playAyah');
const stopAyah = document.getElementById('stopAyah');

const ownerPanelEl = document.getElementById('ownerPanel');
const ownerLogin = document.getElementById('ownerLogin');
const ownerPass = document.getElementById('ownerPass');
const ownerActions = document.getElementById('ownerActions');
const addGlobalBtn = document.getElementById('addGlobalBtn');
const globalTitle = document.getElementById('globalTitle');
const globalUrl = document.getElementById('globalUrl');
const clearAll = document.getElementById('clearAll');
const magnetServer = document.getElementById('magnetServer');

const logArea = document.getElementById('logArea');

const bismillahAudio = document.getElementById('bismillahAudio');
const robotAudio = document.getElementById('robotAudio');
const doorEl = document.getElementById('door');
const robotWrap = document.getElementById('robotWrap');

/* ==================== Utilities ==================== */
function updateClock(){ clockEl.textContent = new Date().toLocaleTimeString(); }
setInterval(updateClock,1000); updateClock();

function log(type,detail=''){ try{ const arr = JSON.parse(localStorage.getItem('cherrak_log')||'[]'); arr.push({t:Date.now(),time:new Date().toLocaleString(),type,detail}); localStorage.setItem('cherrak_log', JSON.stringify(arr)); renderLog(); }catch(e){} }
function renderLog(){ try{ const a = JSON.parse(localStorage.getItem('cherrak_log')||'[]'); logArea.textContent = a.length ? a.slice().reverse().map(i=>`[${i.time}] ${i.type} â€” ${i.detail||''}`).join('\\n') : 'Ø§Ù„Ø³Ø¬Ù„ ÙØ§Ø±Øº'; }catch(e){ logArea.textContent='Ø§Ù„Ø³Ø¬Ù„ ÙØ§Ø±Øº'; } }

function getApps(){ return JSON.parse(localStorage.getItem('cherrak_apps')||'[]'); }
function setApps(arr){ localStorage.setItem('cherrak_apps', JSON.stringify(arr)); renderApps(); }
function renderApps(){
  appsList.innerHTML = '';
  const apps = getApps();
  if(!apps || apps.length===0){ appsList.innerHTML = '<div class="muted">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ·Ø¨ÙŠÙ‚Ø§Øª â€” Ø£Ø¶Ù Ø§Ù„Ø¢Ù†</div>'; return; }
  apps.forEach(a=>{
    const card = document.createElement('div'); card.className='app-card';
    card.innerHTML = `<div class="app-thumb">${(a.title||'').slice(0,2).toUpperCase()}</div>
      <div style="flex:1"><div style="font-weight:700">${a.title}</div><div class="muted">${a.url}</div></div>
      <div style="display:flex;gap:6px">
        <button class="btn openBtn">ÙØªØ­</button>
        <button class="btn ghost delBtn">Ø­Ø°Ù</button>
      </div>`;
    card.querySelector('.openBtn').addEventListener('click', ()=> openSite(a.url));
    card.querySelector('.delBtn').addEventListener('click', ()=> { if(confirm('Ø­Ø°ÙØŸ')) removeApp(a.id); });
    appsList.appendChild(card);
  });
}
function addApp(t,u){
  if(!t||!u) return alert('Ø§Ù…Ù„Ø£ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ø±Ø§Ø¨Ø·');
  const low = (t+' '+u).toLowerCase();
  if(BLOCKED.some(b=> low.includes(b))) return alert('Ù…Ø­ØªÙˆÙ‰ Ù…Ø­Ø¸ÙˆØ±');
  const arr = getApps();
  arr.unshift({id:Date.now(),title:t,url:u});
  setApps(arr);
  log('app_added', `${t} | ${u}`);
}
function removeApp(id){ setApps(getApps().filter(x=>x.id!==id)); log('app_removed', id); }
function openSite(url){
  const low = (url||'').toLowerCase();
  if(BLOCKED.some(b=> low.includes(b))) { alert('Ù…Ø­ØªÙˆÙ‰ Ù…Ø­Ø¸ÙˆØ±'); log('open_block', url); return; }
  // try embed in new tab
  const w = window.open('', '_blank', 'width=1000,height=700');
  try{ w.document.write(`<style>body{margin:0;background:#000;color:#fff}iframe{width:100%;height:100vh;border:none}</style><iframe src="${url}"></iframe>`); }catch(e){ window.open(url,'_blank'); }
  log('open_site', url);
}

/* ==================== Gate logic ==================== */
function inHours(){ const h = new Date().getHours(); return h>=OPEN_HOUR && h < CLOSE_HOUR; }
unlockBtn.addEventListener('click', ()=>{
  const pass = (passwordInput.value||'').trim();
  const age = Number(ageInput.value);
  if(pass !== USER_PASS){ gateMsg.textContent = 'ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø®Ø§Ø·Ø¦Ø© / Wrong password'; log('unlock_failed','wrong_pass'); return; }
  if(isNaN(age) || age < MIN_AGE){ gateMsg.textContent = `ğŸš« Ù…Ù…Ù†ÙˆØ¹ â€” Ø§Ù„Ø¹Ù…Ø± Ø£Ù‚Ù„ Ù…Ù† ${MIN_AGE}`; log('unlock_failed','age_'+age); return; }
  if(!inHours()){ gateMsg.textContent = 'Ø§Ù„Ø®Ø²Ù†Ø© Ù…ØºÙ„Ù‚Ø© Ø§Ù„Ø¢Ù† â€” Ø®Ø§Ø±Ø¬ Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„'; log('unlock_failed','closed_hours'); return; }
  // play sounds and open
  try{ bismillahAudio.play().catch(()=>{}); robotAudio.play().catch(()=>{}); }catch(e){}
  doorLight(true);
  gatePanel.classList.add('hidden'); vaultPanel.classList.remove('hidden');
  log('unlock_success','user_opened');
  passwordInput.value=''; ageInput.value='';
  startAutoLock();
});

lockBtn.addEventListener('click', ()=> autoLock('manual'));
logoutBtn.addEventListener('click', ()=> autoLock('logout'));

// auto lock on inactivity or tab hidden
let autoTimer = null;
function startAutoLock(){ clearTimeout(autoTimer); autoTimer = setTimeout(()=> autoLock('inactive'), 2*60*1000); }
function autoLock(reason){ vaultPanel.classList.add('hidden'); gatePanel.classList.remove('hidden'); doorLight(false); log('auto_lock', reason); }
['mousemove','keydown','touchstart'].forEach(ev=> document.addEventListener(ev, ()=> { if(!vaultPanel.classList.contains('hidden')) startAutoLock(); }));
document.addEventListener('visibilitychange', ()=> { if(document.hidden && !vaultPanel.classList.contains('hidden')) autoLock('tab_hidden'); });

function doorLight(on){
  if(on){ doorEl.style.boxShadow='0 0 200px 50px rgba(0,200,255,0.06), inset 0 0 80px rgba(0,200,255,0.06)'; robotWrap.style.filter='drop-shadow(0 10px 20px rgba(0,200,255,0.25))'; }
  else{ doorEl.style.boxShadow=''; robotWrap.style.filter=''; }
}

/* ==================== Owner panel ========= */
ownerToggle.addEventListener('click', ()=> { ownerPanelEl.classList.toggle('hidden'); });
ownerLogin.addEventListener('click', ()=> {
  if((ownerPass.value||'') === OWNER_PASS){ ownerActions.classList.remove('hidden'); ownerPass.value=''; document.getElementById('ownerMsg').textContent='Owner logged in'; log('owner_login','local'); }
  else document.getElementById('ownerMsg').textContent='Owner password wrong';
});
addGlobalBtn.addEventListener('click', ()=> { let t=globalTitle.value.trim(), u=globalUrl.value.trim(); if(!t||!u) return alert('Fill both'); if(!/^https?:\/\//i.test(u)) u='https://'+u; addApp(t,u); globalTitle.value=''; globalUrl.value=''; });
clearAll.addEventListener('click', ()=> { if(confirm('Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ø±ÙˆØ§Ø¨Ø·ØŸ')){ localStorage.removeItem('cherrak_apps'); renderApps(); log('owner_clear','all'); }});
magnetServer.addEventListener('click', ()=> { alert('Server magnet not configured. Use local Magnet Pull or connect backend.'); log('owner_magnet','not_configured'); });

/* ================= Magnet Pulls (curated) ================ */
magnetBtn.addEventListener('click', ()=> {
  const curated = [
    {title:'Google', url:'https://www.google.com'},
    {title:'Amazon', url:'https://www.amazon.com'},
    {title:'Alibaba', url:'https://www.alibaba.com'},
    {title:'eBay', url:'https://www.ebay.com'},
    {title:'PayPal', url:'https://www.paypal.com'},
    {title:'Instagram', url:'https://www.instagram.com'},
    {title:'TikTok', url:'https://www.tiktok.com'},
    {title:'YouTube', url:'https://www.youtube.com'},
    {title:'Steam', url:'https://store.steampowered.com'},
    {title:'PlayStation', url:'https://www.playstation.com'}
  ];
  const existing = getApps();
  curated.forEach(c => { if(!existing.find(e=> e.url===c.url)) existing.unshift({id:Date.now()+Math.random(), title:c.title, url:c.url}); });
  setApps(existing); log('magnet_local','curated_added');
  alert('Magnet pulled locally: ' + curated.length + ' items');
});

magnetBiz.addEventListener('click', ()=> {
  const existing = getApps();
  MAGNET_BUSINESS.forEach(c => { if(!existing.find(e=> e.url===c.url)) existing.unshift({id:Date.now()+Math.random(), title:c.title, url:c.url}); });
  setApps(existing); log('magnet_business','added'); alert('Business magnet pulled');
});

/* ================= Protect capture (black overlay) ================= */
let protectOn = false;
protectBtn.addEventListener('click', ()=> {
  protectOn = !protectOn;
  protectBtn.textContent = protectOn ? 'Ø­Ù…Ø§ÙŠØ© Ù…ÙØ¹Ù„Ù‘Ø© â€” Ø­Ù…Ø§ÙŠØ© ØªØµÙˆÙŠØ±' : 'Ø­Ù…Ø§ÙŠØ© ØªØµÙˆÙŠØ± / Protect';
  if(protectOn) enableProtect(); else disableProtect();
});
function enableProtect(){
  window.addEventListener('keydown', protectKey);
  window.addEventListener('beforeprint', onBeforePrint);
  document.addEventListener('contextmenu', preventDefault);
}
function disableProtect(){
  window.removeEventListener('keydown', protectKey);
  window.removeEventListener('beforeprint', onBeforePrint);
  document.removeEventListener('contextmenu', preventDefault);
}
function preventDefault(e){ e.preventDefault(); alert('Protected'); }
function protectKey(e){ if(e.ctrlKey && (e.key==='p' || e.key==='P')){ e.preventDefault(); onBeforePrint(); } }
function onBeforePrint(){ const ov=document.createElement('div'); ov.id='protectOverlay'; ov.style.position='fixed'; ov.style.left=0; ov.style.top=0; ov.style.right=0; ov.style.bottom=0; ov.style.background='#000'; ov.style.zIndex=99999; document.body.appendChild(ov); setTimeout(()=>{ const o=document.getElementById('protectOverlay'); if(o) o.remove(); },3000); }

/* ==================== Quran integration (alquran.cloud) ==================== */
/* This uses public API at https://api.alquran.cloud to fetch surah list and verses.
   If API is unavailable, UI still works but without remote Quran content.
*/
const AQ_API = 'https://api.alquran.cloud/v1';
async function loadSurahList(){
  try{
    surahListEl.textContent = 'Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³ÙˆØ±...';
    const r = await fetch(AQ_API + '/surah');
    if(!r.ok) throw new Error('fail');
    const j = await r.json();
    surahListEl.innerHTML = '';
    j.data.forEach(s=>{
      const b = document.createElement('button');
      b.textContent = `${s.number}. ${s.englishName} â€” ${s.name}`;
      b.style.display='block'; b.style.width='100%'; b.style.padding='6px'; b.style.border='none'; b.style.background='transparent'; b.style.color='var(--muted)'; b.style.textAlign='right';
      b.addEventListener('click', ()=> loadSurah(s.number));
      surahListEl.appendChild(b);
    });
  }catch(e){
    surahListEl.textContent='ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³ÙˆØ± â€” API ØºÙŠØ± Ù…ØªÙˆÙØ±';
    console.warn(e);
  }
}
async function loadSurah(n){
  qText.innerHTML = 'ØªØ­Ù…ÙŠÙ„...';
  qTafsir.textContent = '';
  try{
    const r = await fetch(AQ_API + '/surah/' + n + '/ar.alafasy'); // try reciter edition for audio+text
    if(!r.ok) throw new Error('fail');
    const j = await r.json();
    // build text
    const verses = j.data.ayahs || j.data.ayah;
    let html = `<div style="font-size:20px;color:var(--accent);margin-bottom:8px">${j.data.englishName} â€” ${j.data.name}</div>`;
    j.data.ayahs.forEach(a=>{
      html += `<div style="margin-bottom:6px"><strong style="display:block">${a.numberInSurah}. ï´¿${a.text}ï´¾</strong></div>`;
    });
    qText.innerHTML = html;
    // try fetch tafsir (Ibn Kathir) via another endpoint if available
    try{
      const taf = await fetch(AQ_API + '/surah/' + n + '/ar.khaled-algosaibi'); // may not exist
      if(taf.ok){ const tj = await taf.json(); qTafsir.textContent = 'ØªÙØ³ÙŠØ± Ù…ØªØ§Ø­'; }
    }catch(e){}
  }catch(e){
    qText.textContent = 'ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³ÙˆØ±Ø© (API Ù‚Ø¯ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ù‡Ø°Ø§ Ø§Ù„Ù†ÙˆØ¹ Ù…Ù† Ø§Ù„Ø·Ù„Ø¨)';
    console.warn(e);
  }
}
loadSurahList();

/* ========= Quran audio controls - try to play available audio ========== */
playAyah.addEventListener('click', ()=> {
  // attempt: try audio from alquran.cloud for current surah (simple approach)
  // Note: this is best-effort; some editions include audio urls in responses.
  alert('Audio play will use reciter edition if available. If not, use local bismillah file.');
  bismillahAudio.play().catch(()=>{});
});
stopAyah.addEventListener('click', ()=> { try{ bismillahAudio.pause(); bismillahAudio.currentTime = 0; }catch(e){} });

/* ==================== Init & restore ==================== */
(function init(){
  try{ renderApps(); renderLog(); loadSurahList(); }catch(e){}
  // hide owner actions until login
  ownerActions.classList.add('hidden');
})();

/* ===== expose some utilities for debugging (console) ===== */
window.cherrak = { addApp, getApps, setApps, log, openSite, loadSurah };

/* ==================== HIDE SENSITIVE INFO (basic) ==================== */
/* This frontend avoids printing any sensitive config. If you put personal data in localStorage,
   it will be stored locally only. To further hide sensitive information, use a server and never
   expose credentials in client code.
*/
</script>
</body>
</html>

