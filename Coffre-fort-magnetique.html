!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Cherrak Infinity â™¾ï¸ â€” Coffre-Fort MagnÃ©tique</title>
<style>
:root{
  --bg:#020617; --panel:#071827; --accent:#00e0ff; --muted:#9fbcd6; --text:#eaf6ff;
}
*{box-sizing:border-box}
body{margin:0;font-family:system-ui, 'Cairo', Arial;background:radial-gradient(circle at 10% 20%, #071b2b 0%, #020617 45%, #000 100%);color:var(--text);min-height:100vh;display:flex;align-items:center;justify-content:center;padding:18px}
.container{width:100%;max-width:1100px;border-radius:14px;padding:18px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.03)}
.header{display:flex;align-items:center;gap:12px}
.logo{width:72px;height:72px;border-radius:12px;background:linear-gradient(180deg,#032838,#02121a);display:flex;align-items:center;justify-content:center;font-size:30px;color:var(--accent)}
.title{font-size:20px}
.small{color:var(--muted);font-size:13px}
.clock{margin-left:auto;font-size:13px;color:var(--muted)}
.panel{margin-top:14px;padding:12px;border-radius:10px;background:linear-gradient(180deg, rgba(0,0,0,0.18), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.03)}
.row{display:flex;gap:8px;align-items:center}
.input, input, select, textarea{font-size:15px;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit;width:100%}
.btn{background:linear-gradient(90deg,var(--accent),#0072ff);color:#001;padding:10px 14px;border-radius:10px;border:none;cursor:pointer;font-weight:700}
.btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--accent)}
.grid{display:grid;grid-template-columns:1fr 380px;gap:14px}
.hidden{display:none}
.vault-door{position:relative;height:320px;border-radius:12px;background:linear-gradient(180deg,#00131a,#022a37);display:flex;align-items:center;justify-content:center;overflow:hidden}
.door{width:280px;height:260px;background:linear-gradient(180deg,#041a28,#073241);border-radius:8px;box-shadow:inset 0 -40px 80px rgba(0,0,0,0.6), 0 10px 40px rgba(0,0,0,0.6);display:flex;align-items:center;justify-content:center;position:relative;transition:transform .8s ease}
.door.open{transform:translateX(420px)}
.door .lock{position:absolute;right:14px;top:30px;width:72px;height:72px;border-radius:10px;background:#001a22;display:flex;align-items:center;justify-content:center;font-weight:800;color:var(--accent)}
.vault-light{position:absolute;inset:0;background:radial-gradient(circle at 50% 30%, rgba(0,224,255,0.18), rgba(0,224,255,0.06) 12%, transparent 30%);opacity:0;transition:opacity .6s ease, transform .6s ease}
.vault-light.on{opacity:1;transform:scale(1.02)}
.art-right{position:absolute;right:18px;top:12px;width:120px;height:120px;border-radius:12px;overflow:hidden;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px}
.art-right img{width:100%;height:100%;object-fit:cover;border-radius:12px;box-shadow:0 8px 20px rgba(0,0,0,.6)}
.robot-left{position:absolute;left:12px;bottom:14px;width:140px;height:140px;display:flex;align-items:center;justify-content:center}
.robot-left img{width:120px;height:120px}
.magnet{font-size:22px;padding:8px;border-radius:999px;background:linear-gradient(90deg,#ffcd00,#ff7a00);color:#000;font-weight:900;display:inline-block}
.apps-list{display:grid;gap:8px;max-height:260px;overflow:auto;padding-top:6px}
.app-item{display:flex;justify-content:space-between;align-items:center;padding:8px;border-radius:8px;background:rgba(255,255,255,0.01)}
.audit{max-height:200px;overflow:auto;background:rgba(0,0,0,0.12);padding:8px;border-radius:8px}
.footer{margin-top:12px;text-align:center;color:var(--muted);font-size:13px}
.pro-desc{margin-top:10px;color:var(--muted);font-size:14px}
/* black cover for capture protection */
.black-cover{position:fixed;inset:0;background:#000;z-index:9999;display:flex;align-items:center;justify-content:center;color:#111;font-size:18px;opacity:0;pointer-events:none;transition:opacity .25s}
.black-cover.show{opacity:1;pointer-events:auto}
.qr-canvas{width:100%;height:auto;background:white;padding:8px;border-radius:8px}
</style>
</head>
<body>
<div class="container">
  <div class="header">
    <div class="logo">â™¾ï¸</div>
    <div>
      <div class="title">Cherrak Infinity â™¾ï¸ â€” Coffre-Fort MagnÃ©tique</div>
      <div class="small">Ø¨ÙˆØ§Ø¨Ø© Ø°ÙƒÙŠØ© â€¢ Ù†Ø¸Ø§Ù… Ù…ØªÙƒØ§Ù…Ù„ â€¢ Ø®ØµÙˆØµÙŠØ© Ø£ÙˆÙ„Ø§Ù‹</div>
    </div>
    <div class="clock" id="clock">--:--:--</div>
  </div>

  <div class="panel grid">
    <!-- LEFT: Door & controls -->
    <div>
      <div class="vault-door panel">
        <div class="door" id="doorEl" aria-hidden="false">
          <div class="lock">ğŸ”’</div>
          <div style="text-align:center">
            <h2 style="margin:0;color:var(--accent)">ğŸšª Ø§Ù„Ø¨Ø§Ø¨ Ø§Ù„Ø¢Ù…Ù†</h2>
            <div class="small" style="margin-top:6px">Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù„ÙØªØ­ Ø§Ù„Ø®Ø²Ù†Ø©</div>
            <div style="margin-top:12px;max-width:360px;margin-inline:auto">
              <input id="password" class="input" placeholder="Password (Bismillah)" />
              <div style="display:flex;gap:8px;margin-top:8px">
                <button id="unlockBtn" class="btn" style="flex:1">ÙØªØ­ ğŸ”“</button>
                <button id="ownerBtn" class="btn ghost" style="width:140px">Owner</button>
              </div>
            </div>
            <div class="pro-desc" id="doorNote">A fast, comprehensive site and endless AI â€” Cherrak Infinity.</div>
          </div>
        </div>

        <div class="vault-light" id="vaultLight"></div>

        <!-- user photo top-right (replace user.jpg) -->
        <div class="art-right">
          <img id="userPhoto" src="user.jpg" alt="User" onerror="this.style.display='none'"/>
          <div class="small">Owner</div>
        </div>

        <!-- robot left -->
        <div class="robot-left">
          <img id="robotImg" src="robot.png" alt="Robot" onerror="this.style.display='none'"/>
        </div>
      </div>

      <div class="panel" style="margin-top:12px">
        <div class="row" style="align-items:center">
          <div class="magnet">ğŸ§²</div>
          <div style="margin-right:8px">
            <div class="small">Magnet: legal aggregator</div>
            <div class="small">ÙŠØ¬Ù„Ø¨ Ø±ÙˆØ§Ø¨Ø· ÙˆÙ…Ø¹Ù„ÙˆÙ…Ø§Øª Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© Ù…Ù† Ø§Ù„ÙˆÙŠØ¨</div>
          </div>
          <button id="pullBtn" class="btn" style="margin-left:auto">Ø¬Ù„Ø¨ Ù‚Ø§Ù†ÙˆÙ†ÙŠ</button>
        </div>
        <div class="small" style="margin-top:8px">Ù…Ø³Ù…ÙˆØ­: Ø±ÙˆØ§Ø¨Ø· Ø¹Ø§Ù…Ø©ØŒ ÙˆÙŠÙƒÙŠØ¨ÙŠØ¯ÙŠØ§ØŒ Ù†ØªØ§Ø¦Ø¬ Ø¨Ø­Ø«. ØºÙŠØ± Ù…Ø³Ù…ÙˆØ­: Ù…Ø­ØªÙˆÙ‰ Ù…Ø®Ù„ Ø£Ùˆ Ø¶Ø§Ø±.</div>
      </div>
    </div>

    <!-- RIGHT: Vault content -->
    <div>
      <div class="panel">
        <h4>ğŸ” Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø®Ø²Ù†Ø©</h4>
        <div style="display:flex;gap:8px;flex-wrap:wrap">
          <input id="appTitle" placeholder="Ø§Ø³Ù… Ø§Ù„ØªØ·Ø¨ÙŠÙ‚/Ø§Ù„Ù…ÙˆÙ‚Ø¹" class="input" style="flex:1">
          <input id="appUrl" placeholder="https://example.com" class="input" style="flex:1">
          <button id="addAppBtn" class="btn">Ø£Ø¶Ù</button>
        </div>

        <div style="margin-top:10px" class="apps-list" id="appsList">
          <!-- populated by JS -->
        </div>

        <div style="margin-top:12px" class="panel">
          <h4>Quick Links (Popular)</h4>
          <div style="display:flex;flex-wrap:wrap;gap:8px">
            <!-- sample popular -->
            <button class="btn ghost linkBtn" data-url="https://www.google.com">Google</button>
            <button class="btn ghost linkBtn" data-url="https://www.facebook.com">Facebook</button>
            <button class="btn ghost linkBtn" data-url="https://www.instagram.com">Instagram</button>
            <button class="btn ghost linkBtn" data-url="https://www.youtube.com">YouTube</button>
            <button class="btn ghost linkBtn" data-url="https://www.tiktok.com">TikTok</button>
            <button class="btn ghost linkBtn" data-url="https://www.whatsapp.com">WhatsApp</button>
            <button class="btn ghost linkBtn" data-url="https://www.paypal.com">PayPal</button>
            <button class="btn ghost linkBtn" data-url="https://www.amazon.com">Amazon</button>
            <button class="btn ghost linkBtn" data-url="https://www.alibaba.com">Alibaba</button>
            <button class="btn ghost linkBtn" data-url="https://www.ebay.com">eBay</button>
            <button class="btn ghost linkBtn" data-url="https://play.google.com/store">Games (Play)</button>
          </div>
        </div>

        <div style="margin-top:12px" class="panel">
          <h4>Owner Panel (ğŸ”‘)</h4>
          <div class="small">To use owner features enter owner password then click Owner Login</div>
          <div style="display:flex;gap:8px;margin-top:8px">
            <input id="ownerPass" placeholder="Owner password" class="input">
            <button id="ownerLoginBtn" class="btn">Owner Login</button>
            <button id="ownerLogoutBtn" class="btn ghost">Owner Logout</button>
          </div>
        </div>

        <div style="margin-top:12px" class="panel">
          <h4>Audit Log</h4>
          <div id="audit" class="audit small">Ø§Ù„Ø³Ø¬Ù„ ÙØ§Ø±Øº</div>
        </div>

        <div style="margin-top:12px" class="panel">
          <h4>QR / Export</h4>
          <div style="display:flex;gap:8px">
            <input id="qrText" placeholder="Text or URL for QR" class="input">
            <button id="genQrBtn" class="btn">Generate QR</button>
          </div>
          <canvas id="qrCanvas" class="qr-canvas hidden"></canvas>
        </div>
      </div>
    </div>
  </div>

  <div class="footer">Â© Cherrak Infinity â€” Local-first â€¢ Privacy-focused</div>
</div>

<!-- black cover for capture prevention -->
<div id="blackCover" class="black-cover"><div style="text-align:center;color:#777">Protected content â€” Cherrak Infinity</div></div>

<script>
/* ====== Config ====== */
const USER_PASS = "Bismillah";
const OWNER_PASS = "Cherrak Houari";
const MIN_AGE = 12;
const OPEN_HOUR = 8;
const CLOSE_HOUR = 22;
const BLOCKED = ["porn","sex","xxx","nude","erotic","illegal","weapon","malware","virus"];
const AUTO_BLACK_MS = 1200; // how long black cover shows on capture attempt (ms)
const APPS_KEY = "cherrak_apps_v2";
const AUDIT_KEY = "cherrak_audit_v2";

/* ====== DOM ====== */
const clockEl = document.getElementById('clock');
const unlockBtn = document.getElementById('unlockBtn');
const passwordInput = document.getElementById('password');
const doorEl = document.getElementById('doorEl');
const vaultLight = document.getElementById('vaultLight');
const userPhoto = document.getElementById('userPhoto');
const robotImg = document.getElementById('robotImg');
const addAppBtn = document.getElementById('addAppBtn');
const appTitle = document.getElementById('appTitle');
const appUrl = document.getElementById('appUrl');
const appsListEl = document.getElementById('appsList');
const auditEl = document.getElementById('audit');
const ownerBtn = document.getElementById('ownerBtn');
const ownerPassInput = document.getElementById('ownerPass');
const ownerLoginBtn = document.getElementById('ownerLoginBtn');
const ownerLogoutBtn = document.getElementById('ownerLogoutBtn');
const pullBtn = document.getElementById('pullBtn');
const linkBtns = document.querySelectorAll('.linkBtn');
const blackCover = document.getElementById('blackCover');
const genQrBtn = document.getElementById('genQrBtn');
const qrCanvas = document.getElementById('qrCanvas');
const qrText = document.getElementById('qrText');

/* ====== state ====== */
let vaultOpen = false;
let ownerMode = false;

/* ====== clock ====== */
function updateClock(){ clockEl.textContent = new Date().toLocaleString(); }
setInterval(updateClock,1000); updateClock();

/* ====== helpers ====== */
function audit(event, detail=""){ const arr = JSON.parse(localStorage.getItem(AUDIT_KEY)||'[]'); arr.unshift({t:new Date().toLocaleString(),event,detail}); localStorage.setItem(AUDIT_KEY, JSON.stringify(arr)); renderAudit(); }
function renderAudit(){ const arr = JSON.parse(localStorage.getItem(AUDIT_KEY)||'[]'); if(arr.length===0) auditEl.textContent='Ø§Ù„Ø³Ø¬Ù„ ÙØ§Ø±Øº'; else auditEl.innerHTML = arr.map(a=>`[${a.t}] ${a.event} â€” ${a.detail}`).join('<br>'); }
function loadApps(){ return JSON.parse(localStorage.getItem(APPS_KEY)||'[]'); }
function saveApps(arr){ localStorage.setItem(APPS_KEY, JSON.stringify(arr)); renderApps(); }
function renderApps(){ const arr = loadApps(); appsListEl.innerHTML=''; if(arr.length===0){ appsListEl.innerHTML = '<div class="small">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ·Ø¨ÙŠÙ‚Ø§Øª â€” Ø£Ø¶Ù Ø§Ù„Ø¢Ù†</div>'; return; } arr.forEach(a=>{ const el = document.createElement('div'); el.className='app-item'; el.innerHTML = `<div><strong>${escapeHtml(a.title)}</strong><div class="small">${escapeHtml(a.url)}</div></div><div style="display:flex;gap:8px"><button class="btn ghost openBtn" data-url="${a.url}">ÙØªØ­</button><button class="btn ghost delBtn" data-id="${a.id}">Ø­Ø°Ù</button></div>`; appsListEl.appendChild(el); }); }
function escapeHtml(s){ return (s||'').replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;'); }

/* ====== open/close vault ====== */
function isWithinHours(){ const h=new Date().getHours(); return h>=OPEN_HOUR && h < CLOSE_HOUR; }

function openVault(){
  vaultOpen = true;
  doorEl.classList.add('open');
  vaultLight.classList.add('on');
  audit('vault_open','user');
  // play "Bismillah" and robot welcome via Web Speech
  try{
    const u = new SpeechSynthesisUtterance("Ø¨Ø³Ù… Ø§Ù„Ù„Ù‡ Ø§Ù„Ø±Ø­Ù…Ù† Ø§Ù„Ø±Ø­ÙŠÙ…");
    u.lang = 'ar-SA';
    window.speechSynthesis.cancel(); window.speechSynthesis.speak(u);
    const r = new SpeechSynthesisUtterance("Welcome to Cherrak Infinity. The vault is open.");
    r.lang = 'en-US';
    r.rate = 0.95;
    setTimeout(()=> window.speechSynthesis.speak(r), 800);
  }catch(e){ console.warn(e); }
}

function closeVault(reason){
  vaultOpen = false;
  doorEl.classList.remove('open');
  vaultLight.classList.remove('on');
  audit('vault_closed', reason || '');
}

/* unlock click */
unlockBtn.addEventListener('click', ()=>{
  const p = (passwordInput.value || '').trim();
  if(p !== USER_PASS){ alert('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø®Ø§Ø·Ø¦Ø©'); audit('unlock_failed','wrong_pass'); return; }
  // age prompt
  const age = Number(prompt('Ø£Ø¯Ø®Ù„ Ø¹Ù…Ø±Ùƒ (Ø³Ù†Ø©):',''));
  if(isNaN(age) || age < MIN_AGE){ alert(`Ù…Ù…Ù†ÙˆØ¹: Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù„Ø¹Ù…Ø± ${MIN_AGE}`); audit('unlock_failed','age_'+age); return; }
  if(!isWithinHours()){ alert(`Ø§Ù„Ø®Ø²Ù†Ø© ØªÙØªØ­ Ù…Ù† ${OPEN_HOUR}:00 Ø¥Ù„Ù‰ ${CLOSE_HOUR}:00`); audit('unlock_failed','outside_hours'); return; }
  passwordInput.value='';
  openVault();
});

/* owner quick open button: opens owner login dialog */
ownerBtn.addEventListener('click', ()=>{ const p = prompt('Owner password:',''); if(p === OWNER_PASS){ ownerMode = true; audit('owner_login',''); alert('Owner mode enabled'); } else { audit('owner_failed','owner_wrong'); alert('Owner password wrong'); } });

ownerLoginBtn.addEventListener('click', ()=>{
  const p = (ownerPassInput.value||'').trim();
  if(p === OWNER_PASS){ ownerMode = true; audit('owner_login','btn'); alert('Owner mode enabled'); ownerPassInput.value=''; } else { audit('owner_failed','owner_wrong'); alert('Owner password wrong'); }
});
ownerLogoutBtn.addEventListener('click', ()=>{ ownerMode=false; audit('owner_logout',''); alert('Owner logged out'); });

/* add app */
addAppBtn.addEventListener('click', ()=>{
  const t = (appTitle.value||'').trim(); let u = (appUrl.value||'').trim();
  if(!t || !u){ alert('Ø§Ù…Ù„Ø£ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ø±Ø§Ø¨Ø·'); return; }
  if(!/^https?:\/\//i.test(u)) u = 'https://' + u;
  // block check
  const low = (t + ' ' + u).toLowerCase();
  for(const b of BLOCKED){ if(low.includes(b)){ alert('Ù…Ø­ØªÙˆÙ‰ Ù…Ø­Ø¸ÙˆØ±'); audit('add_blocked', b); return; } }
  const arr = loadApps();
  arr.unshift({id:Date.now(),title:t,url:u});
  saveApps(arr);
  appTitle.value=''; appUrl.value='';
  audit('app_added', `${t} | ${u}`);
});

/* open/delete from list */
appsListEl.addEventListener('click', (ev)=>{
  const btn = ev.target;
  if(btn.classList.contains('openBtn')){
    const url = btn.dataset.url;
    window.open(url,'_blank');
    audit('open_app', url);
    return;
  }
  if(btn.classList.contains('delBtn')){
    const id = Number(btn.dataset.id);
    if(!confirm('Ø­Ø°ÙØŸ')) return;
    saveApps(loadApps().filter(a=>a.id!==id));
    audit('app_removed', id);
  }
});

/* popular quick links */
linkBtns.forEach(b=> b.addEventListener('click', ()=>{ const url=b.dataset.url; // open with safety check
  const low = url.toLowerCase();
  for(const bad of BLOCKED){ if(low.includes(bad)){ alert('Ù…Ø­ØªÙˆÙ‰ Ù…Ø­Ø¸ÙˆØ±'); audit('open_blocked', bad); return; } }
  window.open(url,'_blank'); audit('open_quick', url);
}));

/* pull (magnet) legal aggregator: example: ask DuckDuckGo instant & Wikipedia summary (client fallback via open links) */
pullBtn.addEventListener('click', async ()=>{
  if(!vaultOpen && !ownerMode){ alert('Ø§ÙØªØ­ Ø§Ù„Ø®Ø²Ù†Ø© Ø£ÙˆÙ„Ø§Ù‹'); return; }
  audit('magnet_pull','start');
  // simple: open new tab to search aggregator page, and add sample links to vault
  const sample = [
    {title:'Wikipedia: Artificial intelligence', url:'https://en.wikipedia.org/wiki/Artificial_intelligence'},
    {title:'DuckDuckGo search - AI', url:'https://duckduckgo.com/?q=artificial+intelligence'},
    {title:'OpenAI', url:'https://openai.com'}
  ];
  // add to vault (owner only adds to top)
  const arr = loadApps();
  sample.forEach(s=> arr.unshift({id:Date.now()+Math.floor(Math.random()*1000), title:s.title, url:s.url}));
  saveApps(arr);
  audit('magnet_pull','added_sample_links');
  alert('ØªÙ… Ø¬Ù„Ø¨ Ø±ÙˆØ§Ø¨Ø· Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© Ø¹ÙŠÙ†Ø© ÙˆØ¥Ø¶Ø§ÙØªÙ‡Ø§ Ù„Ù„Ø®Ø²Ù†Ø© (Ø±Ø§Ø¬Ø¹ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©)');
});

/* QR generation */
genQrBtn.addEventListener('click', ()=>{
  const txt = (qrText.value || '').trim();
  if(!txt){ alert('Ø§Ø¯Ø®Ù„ Ù†Øµ Ø£Ùˆ Ø±Ø§Ø¨Ø·'); return; }
  // simple QR via canvas using Canvas API + external lib-free algorithm (use Google Chart API? offline use very small QR generator)
  // We'll use a very small implementation by drawing an image from chart.googleapis (works quickly)
  const url = 'https://chart.googleapis.com/chart?cht=qr&chs=300x300&chl=' + encodeURIComponent(txt);
  const ctxCanvas = qrCanvas.getContext('2d');
  const img = new Image();
  img.crossOrigin='anonymous';
  img.onload = ()=> {
    qrCanvas.width = img.width; qrCanvas.height = img.height;
    ctxCanvas.drawImage(img,0,0);
    qrCanvas.classList.remove('hidden');
    audit('qr_generated', txt);
  };
  img.src = url;
});

/* capture protection: show black cover on PrintScreen, Ctrl+P, Ctrl+Shift+I, Ctrl+S, right-click, copy attempt */
function showBlackCover(ms){
  blackCover.classList.add('show');
  setTimeout(()=> blackCover.classList.remove('show'), ms||AUTO_BLACK_MS);
  audit('capture_protect','activated');
}
document.addEventListener('keydown', (e)=>{
  // PrintScreen key
  if(e.key === 'PrintScreen'){ showBlackCover(1200); e.preventDefault(); }
  // Ctrl+P print
  if((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === 'p'){ showBlackCover(1200); /* allow print but darken */ }
  // Ctrl+Shift+I open devtools
  if(e.ctrlKey && e.shiftKey && e.key.toLowerCase()==='i'){ showBlackCover(1500); }
  // Ctrl+S save
  if((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === 's'){ showBlackCover(1000); e.preventDefault(); }
});
document.addEventListener('contextmenu', (e)=>{ e.preventDefault(); showBlackCover(900); });
document.addEventListener('copy', (e)=>{ e.preventDefault(); showBlackCover(900); });

/* visibility / leave -> auto-lock */
document.addEventListener('visibilitychange', ()=>{ if(document.hidden && vaultOpen){ closeVault('tab_hidden'); alert('ØªÙ… Ù‚ÙÙ„ Ø§Ù„Ø®Ø²Ù†Ø© Ø¹Ù†Ø¯ Ù…ØºØ§Ø¯Ø±Ø© Ø§Ù„ØµÙØ­Ø©'); } });

window.addEventListener('beforeunload', ()=>{ if(vaultOpen) closeVault('beforeunload'); });

/* Initialize render */
(function init(){
  renderApps(); renderAudit();
  // make door closed initially
  closeVault('init');
})();

/* helper: show temporary note on clicking door area for demonstration */
doorEl.addEventListener('click', ()=>{ if(!vaultOpen) { /*shake*/ doorEl.animate([{transform:'translateX(0)'},{transform:'translateX(-8px)'},{transform:'translateX(0)'}],{duration:360}) } });

/* prevent developer tools common ways (best effort) */
setInterval(()=>{ if(window.outerHeight - window.innerHeight > 200) { showBlackCover(1200); } }, 2000);

</script>
</body>
</html>

!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Cherrak Infinity â™¾ï¸ â€” Ø§Ù„Ø®Ø²Ù†Ø© Ø§Ù„Ù…ØºÙ†Ø§Ø·ÙŠØ³ÙŠØ©</title>
<meta name="description" content="Cherrak Infinity â€” Vault: smart global library & magnet (Bismillah password)"/>
<style>
:root{
  --bg:#020617; --panel:#071827; --accent:#00e0ff; --muted:#9fbcd6;
  --glass: rgba(255,255,255,0.03);
}
*{box-sizing:border-box}
body{
  margin:0;font-family: "Cairo", system-ui, -apple-system, "Segoe UI", Roboto, Arial;
  background: radial-gradient(circle at 15% 15%, rgba(0,50,70,0.25), #000316 40%), linear-gradient(180deg,#000,#021426);
  color:#eaf6ff; min-height:100vh; display:flex;align-items:center;justify-content:center;padding:18px;
}
.container{width:100%;max-width:1200px;border-radius:12px;overflow:hidden;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005));border:1px solid rgba(255,255,255,0.03);box-shadow:0 30px 80px rgba(0,0,0,0.7)}
.header{display:flex;gap:12px;align-items:center;padding:18px}
.logo{width:64px;height:64px;border-radius:12px;background:radial-gradient(circle,#042a3a,#02111a);display:flex;align-items:center;justify-content:center;font-size:30px;color:var(--accent)}
.title{flex:1}
.title h1{margin:0;font-size:20px;color:#bfefff}
.title p{margin:0;color:var(--muted);font-size:13px}
.clock{font-size:13px;color:var(--muted)}

/* hero */
.hero{display:flex;gap:18px;padding:12px 18px 0 18px;align-items:flex-start}
.robot-wrap{width:150px;min-width:120px;display:flex;align-items:center;justify-content:center}
.robot{width:140px;height:140px;border-radius:12px;background:#021821;background-size:cover;background-position:center;box-shadow:0 8px 30px rgba(0,200,255,0.06);transition:transform .6s}
.robot.animate{transform:translateY(-8px) rotate(-6deg); filter: drop-shadow(0 18px 60px rgba(0,200,255,0.12));}

/* center vault */
.center{flex:1; display:flex; flex-direction:column; align-items:center; gap:12px; padding-bottom:18px}
.vault{width:680px;max-width:92vw;height:420px;border-radius:12px;position:relative; background:linear-gradient(180deg,#021827,#02172a); display:flex; align-items:center; justify-content:center; box-shadow:0 18px 60px rgba(0,0,0,0.6); overflow:hidden}
.vault-bg{position:absolute;inset:0;background-size:cover;background-position:center;opacity:.85}
.vault.glow::after{content:"";position:absolute;inset:-8px;border-radius:16px;box-shadow:0 0 220px 60px rgba(0,200,255,0.10), inset 0 0 90px rgba(0,200,255,0.06);pointer-events:none;transition:opacity .5s}
.vault-inner{position:relative;z-index:3;display:flex;flex-direction:column;align-items:center;gap:10px}

/* big door */
.door{
  width:360px;height:260px;border-radius:10px;background:linear-gradient(180deg,#01202a,#021a25);border:1px solid rgba(255,255,255,0.04);display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden;
  box-shadow: inset 0 -10px 40px rgba(0,0,0,0.5);
}
.door .pad{position:absolute;bottom:18px;left:50%;transform:translateX(-50%);width:86%;display:flex;flex-direction:column;gap:8px;padding:12px}
.door .title{font-weight:800;color:#cff7ff;font-size:18px}

/* light beam */
.beam{
  position:absolute;top:0;left:50%;transform:translateX(-50%) translateY(-60%);width:120%;height:120%;pointer-events:none;opacity:0;transition:opacity .6s;
  background: radial-gradient(ellipse at center, rgba(0,240,255,0.18) 0%, rgba(0,240,255,0.06) 20%, rgba(0,0,0,0) 60%);
  mix-blend-mode:screen;
}

/* door open state */
.vault.open .beam{opacity:1}
.vault.open .door{transform:translateY(-12px) scale(1.02); box-shadow: 0 30px 100px rgba(0,200,255,0.06)}

/* right column (me) */
.right{width:180px;min-width:140px;display:flex;flex-direction:column;align-items:center;padding-right:12px;gap:10px}
.me-photo{width:120px;height:120px;border-radius:12px;background:#041623;background-size:cover;background-position:center;border:2px solid rgba(255,255,255,0.04)}
.owner-btn{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted);padding:8px 10px;border-radius:8px;cursor:pointer}

/* door-panel inputs */
.controls{margin-top:10px;display:flex;gap:8px;justify-content:center;align-items:center;width:100%}
.controls input[type="password"], .controls input[type="number"]{padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:rgba(255,255,255,0.02);color:inherit;font-size:14px}

/* magnet and library */
.magPanel{margin-top:12px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005));padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.02)}
.library{padding:12px 18px;border-top:1px solid rgba(255,255,255,0.02)}
.library h3{margin:0;color:#bfefff}
.apps-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:10px;margin-top:12px}
.app-card{background:rgba(255,255,255,0.02);padding:10px;border-radius:8px;display:flex;align-items:center;gap:10px;border:1px solid rgba(255,255,255,0.02)}
.app-thumb{width:44px;height:44px;border-radius:8px;background:#00161c;display:flex;align-items:center;justify-content:center;font-weight:700;color:var(--accent)}
.app-meta{flex:1}
.app-meta b{display:block;font-size:14px}
.app-meta span{display:block;color:var(--muted);font-size:12px}
.app-actions{display:flex;gap:8px}

/* magnet results */
.magnet-results{margin-top:10px;display:grid;gap:8px;max-height:220px;overflow:auto}
.result-card{background:rgba(0,0,0,0.25);padding:8px;border-radius:8px;display:flex;justify-content:space-between;align-items:center}
.result-meta{max-width:75%}
.result-meta b{display:block}
.result-meta small{display:block;color:var(--muted);font-size:12px}

/* log */
.log{margin-top:12px;background:rgba(0,0,0,0.25);padding:10px;border-radius:8px;max-height:160px;overflow:auto;color:var(--muted);font-size:13px}

/* tagline */
.tagline{padding:12px;text-align:center;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);color:#cfe9ff;font-size:15px}

/* responsive */
@media (max-width:980px){
  .hero{flex-direction:column;align-items:center}
  .right{order:3}
  .robot-wrap{order:1}
  .center{order:2}
  .vault{width:92vw;height:56vh}
}
</style>
</head>
<body>
<div class="container" role="application" aria-label="Cherrak Infinity Vault">
  <div class="header">
    <div class="logo">â™¾ï¸</div>
    <div class="title">
      <h1>Cherrak Infinity â™¾ï¸ â€” Ø§Ù„Ø®Ø²Ù†Ø© Ø§Ù„Ù…ØºÙ†Ø§Ø·ÙŠØ³ÙŠØ©</h1>
      <p>Ù…ÙˆÙ‚Ø¹ Ù…ØªØ·ÙˆØ±: Ø¨Ù†ÙˆÙƒ â€¢ Ù…ØªØ§Ø¬Ø± â€¢ Ø£Ù„Ø¹Ø§Ø¨ â€¢ Ø´Ø¨ÙƒØ§Øª â€¢ Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ â€” ÙƒÙ„ Ø´ÙŠØ¡ ÙÙŠ Ù…ÙƒØ§Ù† ÙˆØ§Ø­Ø¯</p>
    </div>
    <div class="clock" id="clock">--:--:--</div>
  </div>

  <div class="hero">
    <div class="robot-wrap">
      <div id="robot" class="robot" style="background-image:url('robot.png');"></div>
    </div>

    <div class="center">
      <div id="vault" class="vault" aria-hidden="false">
        <div class="vault-bg" style="background-image:url('vault.png');"></div>
        <div class="beam" id="beam"></div>
        <div class="vault-inner">
          <div class="door" id="door">
            <div style="text-align:center;color:#9feafc">
              <div style="font-size:20px;font-weight:800">ğŸšª Cherrak Vault</div>
              <div style="margin-top:8px;color:var(--muted)">Secure â€¢ Clean â€¢ AI-powered</div>
            </div>
            <div class="pad">
              <div class="title">Ø§Ø¯Ø®Ù„ Ø§Ù„Ù…ÙØªØ§Ø­ Ù„ÙØªØ­ Ø§Ù„Ø®Ø²Ù†Ø©</div>
              <div style="margin-top:8px" class="controls">
                <input id="password" type="password" placeholder="Bismillah">
                <input id="age" type="number" min="1" placeholder="Ø§Ù„Ø¹Ù…Ø±" style="width:110px">
                <button id="unlockBtn" class="btn">ÙØªØ­</button>
              </div>
              <div id="msgArea" class="small" style="margin-top:8px;color:var(--muted)"></div>
            </div>
          </div>
        </div>
      </div>

      <div class="magPanel" aria-live="polite">
        <div style="display:flex;gap:8px;align-items:center">
          <input id="magnetQuery" placeholder="Ø¬Ø°Ø¨: Ø§ÙƒØªØ¨ (Amazon, Visa, Fortnite, PayPal, Alibaba)..." style="flex:1;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:rgba(255,255,255,0.02);color:inherit">
          <button id="magnetBtn" class="btn">Ø¬Ø°Ø¨ ğŸ§²</button>
          <button id="magnetClear" class="btn ghost">Ù…Ø³Ø­</button>
        </div>
        <div id="magnetResults" class="magnet-results"></div>
      </div>
    </div>

    <div class="right">
      <div id="mePhoto" class="me-photo" style="background-image:url('me.jpg');"></div>
      <button id="ownerQuick" class="owner-btn">ğŸ‘‘ Owner Login</button>
    </div>
  </div>

  <div class="tagline">
    An advanced, fast and comprehensive AI-powered website. â€” Cherrak Infinity â™¾ï¸ â€” The Vault
  </div>

  <div class="library">
    <h3>ğŸ“š Library â€” All-in-one (Banks â€¢ Stores â€¢ Games â€¢ Socials â€¢ AI)</h3>
    <div class="apps-grid" id="appsList"></div>
    <div id="logArea" class="log">Ø§Ù„Ø³Ø¬Ù„ ÙØ§Ø±Øº</div>
  </div>
</div>

<script>
/* ===== CONFIG ===== */
const USER_PASS = 'Bismillah';
const OWNER_PASS = 'Cherrak Houari';
const MIN_AGE = 12;
const OPEN_HOUR = 8, CLOSE_HOUR = 22;
const AUTO_LOCK_MS = 5*60*1000;
const STORAGE_APPS = 'cherrak_all_apps_v1';
const STORAGE_LOG = 'cherrak_audit_v1';
const BLOCKED = ['porn','sex','xxx','erotic','pornography','hentai','rape','bestiality','malware','virus'];

/* ===== ELEMENTS ===== */
const clockEl = document.getElementById('clock');
const vaultEl = document.getElementById('vault');
const beamEl = document.getElementById('beam');
const robotEl = document.getElementById('robot');
const passwordInput = document.getElementById('password');
const ageInput = document.getElementById('age');
const unlockBtn = document.getElementById('unlockBtn');
const ownerQuick = document.getElementById('ownerQuick');
const appsListEl = document.getElementById('appsList');
const logArea = document.getElementById('logArea');
const msgArea = document.getElementById('msgArea');
const magnetQuery = document.getElementById('magnetQuery');
const magnetBtn = document.getElementById('magnetBtn');
const magnetResults = document.getElementById('magnetResults');
const magnetClear = document.getElementById('magnetClear');

let autoLockTimer = null;

/* ===== helpers ===== */
function nowTimeStr(){ return new Date().toLocaleTimeString(); }
function updateClock(){ clockEl.textContent = nowTimeStr(); }
setInterval(updateClock,1000); updateClock();
function inWorkingHours(){ const h = new Date().getHours(); return h >= OPEN_HOUR && h < CLOSE_HOUR; }
function speakArabic(text){ if('speechSynthesis' in window){ const u = new SpeechSynthesisUtterance(text); u.lang='ar-SA'; window.speechSynthesis.cancel(); window.speechSynthesis.speak(u);} }
function speakRobot(text){ if('speechSynthesis' in window){ const u = new SpeechSynthesisUtterance(text); /* try to pick a robotic-like voice */ u.lang='en-US'; u.rate=0.95; u.pitch=0.8; window.speechSynthesis.cancel(); window.speechSynthesis.speak(u);} }
function log(type, detail=''){ const arr = JSON.parse(localStorage.getItem(STORAGE_LOG)||'[]'); arr.push({t:Date.now(),time:new Date().toLocaleString(),type,detail}); localStorage.setItem(STORAGE_LOG, JSON.stringify(arr)); renderLog(); }
function renderLog(){ const arr = JSON.parse(localStorage.getItem(STORAGE_LOG)||'[]'); if(arr.length===0) logArea.textContent='Ø§Ù„Ø³Ø¬Ù„ ÙØ§Ø±Øº'; else logArea.textContent = arr.slice().reverse().map(i=>`[${i.time}] ${i.type} â€” ${i.detail}`).join('\\n'); }
function isBlocked(url){ const low = (url||'').toLowerCase(); return BLOCKED.some(b=> low.includes(b)); }

/* ===== default apps (big list) ===== */
const DEFAULT_APPS = [
  {title:'Mastercard', url:'https://www.mastercard.com', cat:'Finance'},
  {title:'Visa', url:'https://www.visa.com', cat:'Finance'},
  {title:'PayPal', url:'https://www.paypal.com', cat:'Finance'},
  {title:'Amazon', url:'https://www.amazon.com', cat:'Ecommerce'},
  {title:'Alibaba', url:'https://www.alibaba.com', cat:'Ecommerce'},
  {title:'eBay', url:'https://www.ebay.com', cat:'Ecommerce'},
  {title:'Google', url:'https://www.google.com', cat:'Search'},
  {title:'YouTube', url:'https://www.youtube.com', cat:'Social'},
  {title:'Facebook', url:'https://www.facebook.com', cat:'Social'},
  {title:'Instagram', url:'https://www.instagram.com', cat:'Social'},
  {title:'WhatsApp', url:'https://web.whatsapp.com', cat:'Social'},
  {title:'TikTok', url:'https://www.tiktok.com', cat:'Social'},
  {title:'Steam', url:'https://store.steampowered.com', cat:'Games'},
  {title:'Fortnite', url:'https://www.epicgames.com/fortnite', cat:'Games'},
  {title:'Netflix', url:'https://www.netflix.com', cat:'Media'},
  {title:'OpenAI', url:'https://www.openai.com', cat:'AI'},
  {title:'Cherrak Carte AI', url:'https://cherrakcart.ai', cat:'Cherrak'}
];
if(!localStorage.getItem(STORAGE_APPS)) localStorage.setItem(STORAGE_APPS, JSON.stringify(DEFAULT_APPS));

/* ===== render apps grid ===== */
function renderAppsGrid(){
  const arr = JSON.parse(localStorage.getItem(STORAGE_APPS)||'[]');
  appsListEl.innerHTML = '';
  if(arr.length===0){
    appsListEl.innerHTML = `<div style="color:var(--muted);padding:6px">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø¨Ø¹Ø¯</div>`;
    return;
  }
  arr.forEach((a,i)=>{
    const card = document.createElement('div'); card.className='app-card';
    const thumb = document.createElement('div'); thumb.className='app-thumb'; thumb.textContent = (a.title||'').slice(0,2).toUpperCase();
    const meta = document.createElement('div'); meta.className='app-meta';
    meta.innerHTML = `<b>${a.title}</b><span>${a.cat || ''} â€” ${a.url}</span>`;
    const actions = document.createElement('div'); actions.className='app-actions';
    const open = document.createElement('button'); open.className='btn'; open.textContent='ÙØªØ­'; open.onclick = ()=> openLink(a.url);
    const copy = document.createElement('button'); copy.className='btn ghost'; copy.style.padding='8px'; copy.textContent='Ù†Ø³Ø®'; copy.onclick = ()=> { navigator.clipboard.writeText(a.url); alert('ØªÙ… Ø§Ù„Ù†Ø³Ø®'); };
    actions.appendChild(open); actions.appendChild(copy);
    card.appendChild(thumb); card.appendChild(meta); card.appendChild(actions);
    appsListEl.appendChild(card);
  });
}

/* ===== open link with block check and attempt embed fallback ===== */
function openLink(url){
  if(isBlocked(url)){ alert('Ù…Ø­ØªÙˆÙ‰ Ù…Ø­Ø¸ÙˆØ± â€” Ù…Ù…Ù†ÙˆØ¹ Ø§Ù„Ø¯Ø®ÙˆÙ„'); log('open_blocked', url); return; }
  window.open(url,'_blank');
  log('open_site', url);
}

/* ===== vault open/close visuals & audio ===== */
function vaultOpenActions(who='user'){
  document.querySelector('.container').classList.add('open');
  vaultEl.classList.add('open');
  beamEl.style.opacity = '1';
  robotEl.classList.add('animate');
  // play "Bismillah" via TTS Arabic then robot says welcome
  speakArabic('Ø¨Ø³Ù… Ø§Ù„Ù„Ù‡ Ø§Ù„Ø±Ø­Ù…Ù† Ø§Ù„Ø±Ø­ÙŠÙ…');
  setTimeout(()=> speakRobot(who==='owner' ? 'Welcome owner Cherrak Houari' : 'Welcome to Cherrak Vault'), 900);
  // render overlay content
  loadVaultContent();
  log('unlock_success', who);
  setAutoLockTimer();
}
function vaultCloseActions(reason='manual'){
  document.querySelector('.container').classList.remove('open');
  vaultEl.classList.remove('open');
  beamEl.style.opacity = '0';
  robotEl.classList.remove('animate');
  log('auto_lock', reason);
  // stop any ongoing speech
  if('speechSynthesis' in window) window.speechSynthesis.cancel();
}

/* auto-lock timer */
function setAutoLockTimer(){
  clearAutoLockTimer();
  autoLockTimer = setTimeout(()=>{ vaultCloseActions('inactivity'); alert('ØªÙ… Ù‚ÙÙ„ Ø§Ù„Ø®Ø²Ù†Ø© Ù„Ø¹Ø¯Ù… Ø§Ù„Ù†Ø´Ø§Ø·'); }, AUTO_LOCK_MS);
}
function clearAutoLockTimer(){ if(autoLockTimer){ clearTimeout(autoLockTimer); autoLockTimer=null; } }

/* visibility -> lock when leaving */
document.addEventListener('visibilitychange', ()=>{ if(document.hidden && vaultEl.classList.contains('open')){ vaultCloseActions('tab_hidden'); } });

/* unlock logic */
unlockBtn.addEventListener('click', ()=>{
  msgArea.textContent = '';
  const pass = (passwordInput.value||'').trim();
  const age = Number(ageInput.value);
  if(!inWorkingHours()){ msgArea.textContent = `ğŸš« Ø§Ù„Ø®Ø²Ù†Ø© ØªØ¹Ù…Ù„ Ù…Ù† ${OPEN_HOUR}:00 Ø¥Ù„Ù‰ ${CLOSE_HOUR}:00`; log('unlock_failed','out_of_hours'); return; }
  if(isNaN(age) || age < MIN_AGE){ msgArea.textContent = `ğŸš« ÙŠÙ…Ù†Ø¹ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù…Ù† Ù‡Ù… ØªØ­Øª ${MIN_AGE}`; log('unlock_failed','age_'+age); return; }
  if(pass === USER_PASS){ vaultOpenActions('user'); passwordInput.value=''; ageInput.value=''; return; }
  if(pass === OWNER_PASS){ vaultOpenActions('owner'); passwordInput.value=''; ageInput.value=''; return; }
  msgArea.textContent = 'âŒ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø®Ø§Ø·Ø¦Ø©'; log('unlock_failed','wrong_password');
});

/* owner quick action */
ownerQuick.addEventListener('click', ()=>{
  const p = prompt('Owner password:');
  if(p === OWNER_PASS){
    if(!vaultEl.classList.contains('open')) vaultOpenActions('owner');
    setTimeout(()=> openOwnerPanel(), 400);
  } else { alert('Owner password incorrect'); log('owner_failed','wrong_password'); }
});

/* owner panel simple */
function openOwnerPanel(){
  const cmd = prompt('Owner panel (add / remove / clearlog / showlog):');
  if(!cmd) return;
  if(cmd === 'add'){
    const t = prompt('Title:'); const u = prompt('URL:');
    if(!t || !u) return alert('Missing');
    const arr = JSON.parse(localStorage.getItem(STORAGE_APPS)||'[]'); arr.unshift({title:t,url:u,cat:'Owner'}); localStorage.setItem(STORAGE_APPS, JSON.stringify(arr)); renderAppsGrid(); log('owner_add', t); alert('Added');
  } else if(cmd === 'remove'){
    const t = prompt('Title to remove:'); let arr = JSON.parse(localStorage.getItem(STORAGE_APPS)||'[]'); const before=arr.length; arr = arr.filter(i=>i.title.toLowerCase()!==t.toLowerCase()); localStorage.setItem(STORAGE_APPS, JSON.stringify(arr)); renderAppsGrid(); log('owner_remove', t); alert('Removed ' + (before-arr.length));
  } else if(cmd === 'clearlog'){
    if(confirm('Clear audit log?')){ localStorage.removeItem(STORAGE_LOG); renderLog(); alert('Cleared'); log('owner_action','clearlog'); }
  } else if(cmd === 'showlog'){ alert(localStorage.getItem(STORAGE_LOG) || 'Empty'); }
}

/* load content to vault overlay */
function loadVaultContent(){
  // simple message + apps loaded is shown by renderAppsGrid below
  renderAppsGrid();
}

/* magnet: DuckDuckGo + Wikipedia + search links */
async function magnetPull(query){
  if(!query || query.trim().length < 2) return alert('Ø§ÙƒØªØ¨ ÙƒÙ„Ù…Ø© Ø¨Ø­Ø« Ø£Ø·ÙˆÙ„');
  magnetResults.innerHTML = `<div style="color:var(--muted)">Ø¬Ù„Ø¨ Ø§Ù„Ù†ØªØ§Ø¦Ø¬... (${query})</div>`;
  log('magnet_search', query);
  const results = [];
  // DuckDuckGo instant answer
  try{
    const ddg = `https://api.duckduckgo.com/?q=${encodeURIComponent(query)}&format=json&no_html=1&skip_disambig=1&origin=*`;
    const r = await fetch(ddg);
    if(r.ok){ const j = await r.json();
      if(j.AbstractURL) results.push({title:j.Heading||j.AbstractText||query, url:j.AbstractURL, source:'DuckDuckGo'});
      if(Array.isArray(j.Results)) j.Results.slice(0,5).forEach(it=>{ if(it.FirstURL) results.push({title:it.Text||it.Result||query,url:it.FirstURL,source:'DuckDuckGo'}); });
      if(Array.isArray(j.RelatedTopics)) j.RelatedTopics.slice(0,6).forEach(rt=>{ if(rt.FirstURL) results.push({title:rt.Text||rt.Name||query,url:rt.FirstURL,source:'DuckDuckGo'}); if(rt.Topics) rt.Topics.slice(0,3).forEach(t2=>{ if(t2.FirstURL) results.push({title:t2.Text||t2.Name,url:t2.FirstURL,source:'DuckDuckGo'}); }); });
    }
  }catch(e){ console.warn('ddg',e); }
  // Wikipedia
  try{
    const w = `https://en.wikipedia.org/w/api.php?action=query&list=search&srsearch=${encodeURIComponent(query)}&format=json&origin=*`;
    const r2 = await fetch(w);
    if(r2.ok){ const j2 = await r2.json(); if(j2.query && Array.isArray(j2.query.search)) j2.query.search.slice(0,5).forEach(s=>{ const title=s.title; results.push({title, url:`https://en.wikipedia.org/wiki/${encodeURIComponent(title.replace(/ /g,'_'))}`, source:'Wikipedia'}); }); }
  }catch(e){ console.warn('wiki',e); }
  // ready search links
  results.push({title:`Google search: ${query}`, url:`https://www.google.com/search?q=${encodeURIComponent(query)}`, source:'Search'});
  results.push({title:`YouTube: ${query}`, url:`https://www.youtube.com/results?search_query=${encodeURIComponent(query)}`, source:'Search'});

  // dedupe & filter blocked
  const seen = new Set(); const dedup=[];
  for(const it of results){ if(!it.url) continue; const key = it.url.split('#')[0]; if(!seen.has(key)){ seen.add(key); if(!isBlocked(it.url)) dedup.push(it); } }
  if(dedup.length===0){ magnetResults.innerHTML='<div style="color:var(--muted)">Ù„Ø§ Ù†ØªØ§Ø¦Ø¬ Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© Ù…ØªØ§Ø­Ø©.</div>'; return; }
  magnetResults.innerHTML=''; dedup.forEach(it=>{
    const card = document.createElement('div'); card.className='result-card';
    const meta = document.createElement('div'); meta.className='result-meta'; meta.innerHTML = `<b>${it.title}</b><small>${it.source} â€” ${it.url}</small>`;
    const actions = document.createElement('div');
    const addBtn = document.createElement('button'); addBtn.className='btn'; addBtn.textContent='Ø£Ø¶Ù Ø¥Ù„Ù‰ Ø§Ù„Ø®Ø²Ù†Ø©';
    const openBtn = document.createElement('button'); openBtn.className='btn ghost'; openBtn.textContent='ÙØªØ­';
    actions.appendChild(addBtn); actions.appendChild(openBtn);
    card.appendChild(meta); card.appendChild(actions);
    magnetResults.appendChild(card);
    openBtn.addEventListener('click', ()=>{ window.open(it.url,'_blank'); log('magnet_open', it.url); });
    addBtn.addEventListener('click', ()=>{
      const arr = JSON.parse(localStorage.getItem(STORAGE_APPS)||'[]'); arr.unshift({title:it.title,url:it.url,cat:'Magnet'}); localStorage.setItem(STORAGE_APPS, JSON.stringify(arr)); renderAppsGrid(); log('magnet_add', it.url); addBtn.textContent='Ù…Ø¶Ø§Ù'; addBtn.disabled=true;
    });
  });
}

/* event listeners */
magnetBtn.addEventListener('click', ()=> magnetPull(magnetQuery.value));
magnetClear.addEventListener('click', ()=>{ magnetQuery.value=''; magnetResults.innerHTML=''; });

/* init */
function init(){ renderAppsGrid(); renderLog(); }
init();

/* allow Enter key */
passwordInput.addEventListener('keydown',(e)=>{ if(e.key==='Enter') unlockBtn.click(); });
magnetQuery.addEventListener('keydown',(e)=>{ if(e.key==='Enter') magnetBtn.click(); });

/* expose console helpers */
window.cherrak = { addApp: (t,u)=>{ const arr=JSON.parse(localStorage.getItem(STORAGE_APPS)||'[]'); arr.unshift({title:t,url:u}); localStorage.setItem(STORAGE_APPS, JSON.stringify(arr)); renderAppsGrid(); }, openVault: ()=>{ vaultOpenActions('user'); } };
</script>
</body>
</html>
